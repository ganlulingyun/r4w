<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>R4W - claude</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">R4W - claude</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#claude.md" id="toc-claude.md">CLAUDE.md</a>
<ul>
<li><a href="#project-overview" id="toc-project-overview">Project
Overview</a>
<ul>
<li><a href="#architecture" id="toc-architecture">Architecture</a></li>
<li><a href="#key-commands" id="toc-key-commands">Key Commands</a></li>
<li><a href="#waveform-development"
id="toc-waveform-development">Waveform Development</a></li>
<li><a href="#technical-notes" id="toc-technical-notes">Technical
Notes</a></li>
<li><a href="#recent-updates" id="toc-recent-updates">Recent
Updates</a></li>
</ul></li>
<li><a href="#requirements-management"
id="toc-requirements-management">Requirements Management</a>
<ul>
<li><a href="#cli-commands" id="toc-cli-commands">CLI Commands</a></li>
<li><a href="#during-development" id="toc-during-development">During
Development</a></li>
<li><a href="#session-workflow" id="toc-session-workflow">Session
Workflow</a></li>
</ul></li>
<li><a href="#code-traceability" id="toc-code-traceability">Code
Traceability</a>
<ul>
<li><a href="#inline-trace-comments"
id="toc-inline-trace-comments">Inline Trace Comments</a></li>
<li><a href="#commit-message-format"
id="toc-commit-message-format">Commit Message Format</a></li>
</ul></li>
<li><a href="#claude-code-skills" id="toc-claude-code-skills">Claude
Code Skills</a>
<ul>
<li><a href="#aida-req" id="toc-aida-req">/aida-req</a></li>
<li><a href="#aida-implement"
id="toc-aida-implement">/aida-implement</a></li>
<li><a href="#aida-capture" id="toc-aida-capture">/aida-capture</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="claude.md">CLAUDE.md</h1>
<p>This file provides guidance to Claude Code (claude.ai/code) when
working with code in this repository.</p>
<h2 id="project-overview">Project Overview</h2>
<p><strong>R4W - Rust for Waveforms</strong> - A platform for
developing, testing, and deploying SDR waveforms in Rust. Provides
reusable DSP libraries, educational tools, and production-ready
components for waveform development.</p>
<h3 id="architecture">Architecture</h3>
<ul>
<li><strong>r4w-core</strong>: Core DSP algorithms, timing, RT
primitives, configuration
<ul>
<li><code>waveform/</code>: 42+ waveform implementations (including
GNSS: GPS L1 C/A, GPS L5, GLONASS L1OF, Galileo E1)</li>
<li><code>waveform/gnss/environment/</code>: Keplerian orbits, Klobuchar
ionosphere, Saastamoinen troposphere, multipath presets, antenna
patterns</li>
<li><code>waveform/gnss/scenario*.rs</code>: Multi-satellite GNSS IQ
scenario generation with realistic channel effects</li>
<li><code>coordinates.rs</code>: ECEF/LLA coordinate types, geodetic
conversions, look angles, range rate, FSPL</li>
<li><code>analysis/</code>: Spectrum analyzer, waterfall generator,
signal statistics, peak detection</li>
<li><code>timing.rs</code>: Multi-clock model (SampleClock, WallClock,
HardwareClock, SyncedTime)</li>
<li><code>rt/</code>: Lock-free ring buffers, buffer pools, RT thread
spawning</li>
<li><code>config.rs</code>: YAML-based configuration system</li>
</ul></li>
<li><strong>r4w-sim</strong>: SDR simulation, HAL traits, channel models
<ul>
<li><code>hal/</code>: StreamHandle, TunerControl, ClockControl,
SdrDeviceExt traits</li>
<li><code>channel.rs</code>: AWGN, Rayleigh, Rician, CFO, TDL multipath
(EPA/EVA/ETU), Jake’s Doppler</li>
<li><code>doppler.rs</code>: Jake’s/Clarke’s, Flat, and Gaussian Doppler
models</li>
<li><code>scenario/</code>: Generic multi-emitter IQ scenario engine
(trajectory, emitter trait, Doppler/FSPL/noise)</li>
<li><code>simulator.rs</code>: Software SDR simulator</li>
</ul></li>
<li><strong>r4w-fpga</strong>: FPGA acceleration (Xilinx Zynq, Lattice
iCE40/ECP5)</li>
<li><strong>r4w-sandbox</strong>: Waveform isolation (8 security
levels)</li>
<li><strong>r4w-gui</strong>: Educational egui application (run with
<code>cargo run --bin r4w-explorer</code>)</li>
<li><strong>r4w-cli</strong>: Command-line interface (run with
<code>cargo run --bin r4w</code>)</li>
<li><strong>r4w-web</strong>: WebAssembly entry point for browser
deployment</li>
</ul>
<h3 id="key-commands">Key Commands</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run GUI</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w-explorer</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CLI examples</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> info <span class="at">--sf</span> 7 <span class="at">--bw</span> 125</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> simulate <span class="at">--message</span> <span class="st">&quot;Hello R4W!&quot;</span> <span class="at">--snr</span> 10.0</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> waveform <span class="at">--list</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Mesh networking</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> mesh info</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> mesh status <span class="at">--preset</span> LongFast <span class="at">--region</span> US</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> mesh send <span class="at">-m</span> <span class="st">&quot;Hello mesh!&quot;</span> <span class="at">--dest</span> broadcast</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> mesh simulate <span class="at">--nodes</span> 4 <span class="at">--messages</span> 10</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Waveform comparison (BER vs SNR)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> compare <span class="at">-w</span> BPSK,QPSK,16QAM <span class="at">--snr-min</span> <span class="at">-5</span> <span class="at">--snr-max</span> 20</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> compare <span class="at">--list</span>  <span class="co"># Show available waveforms</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Shell completions (bash/zsh/fish/powershell)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> completions bash <span class="op">&gt;</span> ~/.local/share/bash-completion/completions/r4w</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Record/Playback signals (SigMF format)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> record <span class="at">-o</span> test.sigmf <span class="at">--generate</span> tone <span class="at">--duration</span> 5.0</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> playback <span class="at">-i</span> test.sigmf <span class="at">--info</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># GNSS signal exploration</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss info <span class="at">--signal</span> all</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss compare</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss code <span class="at">--prn</span> 1 <span class="at">--cross-prn</span> 7</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss simulate <span class="at">--prn</span> 1 <span class="at">--cn0</span> 40 <span class="at">--doppler</span> 1000</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss generate <span class="at">--signal</span> GPS-L1CA <span class="at">--prn</span> 1 <span class="at">--bits</span> 10</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># GNSS scenario generation (multi-satellite IQ with channel effects)</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss scenario <span class="at">--list-presets</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss scenario <span class="at">--preset</span> open-sky <span class="at">--duration</span> 0.001 <span class="at">--output</span> test.iq</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss scenario <span class="at">--preset</span> urban-canyon <span class="at">--duration</span> 0.01</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> gnss scenario <span class="at">--preset</span> multi-constellation <span class="at">--sample-rate</span> 4092000</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Signal analysis</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> analyze spectrum <span class="at">-i</span> file.sigmf-meta <span class="at">--fft-size</span> 1024</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> analyze waterfall <span class="at">-i</span> file.sigmf-meta <span class="at">--output</span> waterfall.png</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> analyze stats <span class="at">-i</span> file.sigmf-meta <span class="at">--format</span> json</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> analyze peaks <span class="at">-i</span> file.sigmf-meta <span class="at">--threshold</span> 10</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate gallery images</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--example</span> gallery_generate <span class="at">-p</span> r4w-sim <span class="at">--features</span> image</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Prometheus metrics</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> metrics <span class="at">--format</span> prometheus</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">--bin</span> r4w <span class="at">--</span> metrics <span class="at">--serve</span> <span class="at">--port</span> 9090</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Run in browser (WASM)</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> crates/r4w-web <span class="kw">&amp;&amp;</span> <span class="ex">trunk</span> serve</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Docker</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-it</span> r4w:latest r4w <span class="at">--help</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> run r4w-dev  <span class="co"># Development container</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># cargo-binstall (pre-built binaries)</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> binstall r4w-cli</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-compile for ARM</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> build-cli-arm64</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> deploy-arm64 REMOTE_HOST=joe@raspberrypi</span></code></pre></div>
<h3 id="waveform-development">Waveform Development</h3>
<p>All waveforms implement the <code>Waveform</code> trait: -
<code>modulate(&amp;self, bits: &amp;[bool]) -&gt; Vec&lt;IQSample&gt;</code>
-
<code>demodulate(&amp;self, samples: &amp;[IQSample]) -&gt; Vec&lt;bool&gt;</code>
- <code>constellation_points(&amp;self) -&gt; Vec&lt;IQSample&gt;</code>
- <code>get_modulation_stages()</code> /
<code>get_demodulation_steps()</code> for education</p>
<p>See OVERVIEW.md for the full Waveform Developer’s Guide and Porting
Guide.</p>
<h3 id="technical-notes">Technical Notes</h3>
<ul>
<li>LoRa uses Chirp Spread Spectrum (CSS) modulation</li>
<li>FFT-based demodulation (multiply by downchirp, find peak)</li>
<li>Pipeline: Whitening → Hamming FEC → Interleaving → Gray Code →
CSS</li>
<li>Spreading factors 5-12, bandwidths 125/250/500 kHz</li>
<li>PSK/FSK/QAM waveforms for comparison and education</li>
</ul>
<h3 id="recent-updates">Recent Updates</h3>
<ul>
<li><strong>GNSS IQ Scenario Generator</strong> - Multi-satellite
composite IQ generation with Keplerian orbits, Klobuchar ionosphere,
Saastamoinen troposphere, multipath presets, antenna patterns, orbital
Doppler, and FSPL. CLI: <code>r4w gnss scenario</code>. GUI: GNSS
Simulator view with sky plot and C/N0 bars. Presets: OpenSky,
UrbanCanyon, Driving, Walking, HighDynamics, MultiConstellation.</li>
<li><strong>Generic Scenario Engine</strong> - Reusable multi-emitter IQ
composition framework in r4w-sim with <code>Emitter</code> trait,
trajectory models, per-emitter Doppler/path-loss/channel, and composite
noise.</li>
<li><strong>Coordinate Library</strong> - ECEF/LLA/ENU types with WGS-84
conversions, look angles, range rate, FSPL in r4w-core.</li>
<li><strong>GNSS Environment Models</strong> - Keplerian orbit
propagation (GPS/Galileo/GLONASS nominal orbits), Klobuchar ionospheric
delay, Saastamoinen tropospheric delay, multipath presets
(OpenSky/Suburban/UrbanCanyon/Indoor), antenna patterns
(Isotropic/Patch/ChokeRing).</li>
<li><strong>Jupyter Workshops</strong> - 10 interactive tutorials
including GNSS scenario generation and environment models
(<code>notebooks/09_*.ipynb</code>,
<code>notebooks/10_*.ipynb</code>)</li>
<li><strong>GNSS Waveforms</strong> - GPS L1 C/A, GPS L5, GLONASS L1OF,
Galileo E1 with PRN code generation, FFT-based PCPS acquisition, DLL/PLL
tracking loops, navigation data encoding/decoding, and
<code>r4w gnss</code> CLI subcommand</li>
<li><strong>Enhanced Channel Simulation</strong> - Jake’s/Clarke’s
Doppler model, Tapped Delay Line (TDL) multipath with 3GPP profiles
(EPA, EVA, ETU)</li>
<li><strong>CLI Analysis Tools</strong> - <code>r4w analyze</code>
subcommands: spectrum, waterfall, stats, peaks</li>
<li><strong>Signal Gallery</strong> - 23 PNG images: constellations,
spectra, channel effects (<code>gallery/</code>)</li>
<li><strong>Jupyter Notebooks</strong> - 8 interactive tutorials with
Python wrapper (<code>notebooks/</code>)</li>
<li><strong>Deployment Options</strong> - Docker image, cargo-binstall
manifest, GitHub Actions release workflow</li>
<li><strong>CLI Enhancements</strong> - Record/Playback (SigMF),
Prometheus metrics, shell completions, waveform comparison</li>
<li><strong>Example Gallery</strong> - Getting-started examples for
modulation, channels, LoRa, mesh networking</li>
<li><strong>GitHub Actions CI</strong> - Automated testing,
cross-platform builds, WASM builds, performance regression tracking</li>
<li><strong>Mesh CLI Commands</strong> - <code>r4w mesh</code>
subcommands for LoRa mesh networking (status, send, neighbors, simulate,
info)</li>
<li><strong>Mesh Networking Module</strong> - Full mesh stack with
MeshtasticNode, FloodRouter, CSMA/CA MAC, LoRaMesh integration</li>
<li><strong>Physical Layer Architecture</strong> (Session 18):
<ul>
<li>Multi-clock timing model (SampleClock, WallClock, HardwareClock,
GPS/PTP SyncedTime)</li>
<li>Real-time primitives (lock-free SPSC ring buffers, buffer pools, RT
thread spawning)</li>
<li>YAML configuration system with hardware profiles</li>
<li>Enhanced HAL traits (StreamHandle, TunerControl, ClockControl)</li>
</ul></li>
<li>Added TETRA, DMR, and 3G ALE waveform implementations</li>
<li>Enhanced waveform-spec schema with TDMA/FDMA, radar, classified
components</li>
<li>Renamed project to “R4W - Rust for Waveforms”</li>
<li>Created platform vision with Waveform Developer’s Guide</li>
<li>Documented FPGA integration architecture</li>
<li>Remote Lab for distributed testing on Raspberry Pis</li>
</ul>
<h2 id="requirements-management">Requirements Management</h2>
<p>This project uses AIDA for requirements tracking. <strong>Do NOT
maintain a separate REQUIREMENTS.md file.</strong></p>
<p>Requirements database: <code>requirements.yaml</code></p>
<h3 id="cli-commands">CLI Commands</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">aida</span> list                              <span class="co"># List all requirements</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aida</span> list <span class="at">--status</span> draft               <span class="co"># Filter by status</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">aida</span> show <span class="op">&lt;</span>ID<span class="op">&gt;</span>                         # Show requirement details <span class="er">(</span><span class="ex">e.g.,</span> FR-0042<span class="kw">)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">aida</span> add <span class="at">--title</span> <span class="st">&quot;...&quot;</span> <span class="at">--description</span> <span class="st">&quot;...&quot;</span> <span class="at">--status</span> draft  <span class="co"># Add new requirement</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">aida</span> edit <span class="op">&lt;</span>ID<span class="op">&gt;</span> --status completed      <span class="co"># Update status</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ex">aida</span> comment add <span class="op">&lt;</span>ID<span class="op">&gt;</span> <span class="st">&quot;...&quot;</span>            <span class="co"># Add implementation note</span></span></code></pre></div>
<h3 id="during-development">During Development</h3>
<ul>
<li>When implementing a feature, update its requirement status</li>
<li>Add comments to requirements with implementation decisions</li>
<li>Create child requirements for sub-tasks discovered during
implementation</li>
<li>Link related requirements with:
<code>aida rel add --from &lt;FROM&gt; --to &lt;TO&gt; --type &lt;Parent|Verifies|References&gt;</code></li>
</ul>
<h3 id="session-workflow">Session Workflow</h3>
<p>If you work conversationally without explicit /aida-req calls, use
<code>/aida-capture</code> at session end to review and capture any
requirements that were discussed but not yet added to the database.</p>
<h2 id="code-traceability">Code Traceability</h2>
<h3 id="inline-trace-comments">Inline Trace Comments</h3>
<p>When implementing requirements, add inline trace comments:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// trace:FR-0042 | ai:claude</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> implement_feature() <span class="op">{</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Implementation</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Format:
<code>// trace:&lt;SPEC-ID&gt; | ai:&lt;tool&gt;[:&lt;confidence&gt;]</code></p>
<h3 id="commit-message-format">Commit Message Format</h3>
<p><strong>Standard format:</strong></p>
<pre><code>[AI:tool] type(scope): description (REQ-ID)</code></pre>
<p><strong>Examples:</strong></p>
<pre><code>[AI:claude] feat(auth): add login validation (FR-0042)
[AI:claude:med] fix(api): handle null response (BUG-0023)
chore(deps): update dependencies
docs: update README</code></pre>
<p><strong>Rules:</strong> - <code>[AI:tool]</code> - Required when
commit includes AI-assisted code - <code>type</code> - Required: feat,
fix, docs, style, refactor, perf, test, build, ci, chore, revert -
<code>(scope)</code> - Optional: component or area affected -
<code>(REQ-ID)</code> - Required for feat/fix commits, optional for
chore/docs</p>
<p><strong>Confidence levels:</strong> - <code>[AI:claude]</code> - High
confidence (implied, &gt;80% AI-generated) -
<code>[AI:claude:med]</code> - Medium (40-80% AI with modifications) -
<code>[AI:claude:low]</code> - Low (&lt;40% AI, mostly human)</p>
<p><strong>Configuration:</strong> Set
<code>AIDA_COMMIT_STRICT=true</code> to reject non-conforming commits,
or create <code>.aida/commit-config</code>.</p>
<h2 id="claude-code-skills">Claude Code Skills</h2>
<p>This project uses AIDA requirements-driven development:</p>
<h3 id="aida-req">/aida-req</h3>
<p>Add new requirements with AI evaluation: - Interactive requirement
gathering - Immediate database storage with draft status - Background AI
evaluation for quality feedback - Follow-up actions: improve, split,
link, accept</p>
<h3 id="aida-implement">/aida-implement</h3>
<p>Implement requirements with traceability: - Load and display
requirement context - Break down into child requirements as needed -
Update requirements during implementation - Add inline traceability
comments to code</p>
<h3 id="aida-capture">/aida-capture</h3>
<p>Review session and capture missed requirements: - Scan conversation
for discussed features/bugs/ideas - Identify implemented work not yet in
requirements database - Prompt to add missing requirements or update
statuses - Use at end of conversational sessions as a safety net</p>
</body>
</html>
